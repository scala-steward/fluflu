build:
  box:
    id: hseeberger/scala-sbt
  steps:
    - script:
        name: sbt test
        code: |
          for v in "2.11.8" "2.12.0"; do
            sbt ++${v} coverage clean test coverageReport
          done

    - script:
        name: push coverage report to codecov
        code: |
          bash <(curl -s https://codecov.io/bash)

deploy:
  box:
    id: hseeberger/scala-sbt
  steps:
    - script:
        name: deploy to snapshot repository
        code: |
          mkdir -p .sbt/gpg
          if [ $(cat version.sbt) =~ "-SNAPSHOT" ]; then
            for v in "2.11.8" "2.12.0"; do
              sbt ++${v} publishSigned
            done
          fi
